<div class="container my-5">
  <div class="flashcard-show-header">
    <h2>ðŸ§  <%= @quiz.title %></h2>
    <p class="text-muted">
      <%= @quiz.category.title %> | Niveau <%= @quiz.level %> | <%= @questions.count %> questions
    </p>
  </div>

  <!-- Best Score Card -->
  <% if @best_attempt %>
    <div class="flashcard-progress-card">
      <div class="progress-header">
        <span class="progress-label">Meilleur Score</span>
        <span class="progress-count"><%= @best_attempt.score %> / <%= @best_attempt.total_questions %> (<%= @best_attempt.percentage_score %>%)</span>
      </div>
      <div class="progress">
        <div class="progress-bar progress-bar-striped" role="progressbar"
             style="width: <%= @best_attempt.percentage_score %>%; background-color: <%= @best_attempt.percentage_score == 100 ? '#28a745' : '#1351AA' %>;"
             aria-valuenow="<%= @best_attempt.percentage_score %>" aria-valuemin="0" aria-valuemax="100">
          <%= @best_attempt.percentage_score %>%
        </div>
      </div>
    </div>
  <% end %>

  <!-- Start Quiz Button -->
  <div class="text-center my-4">
    <%= button_to "Commencer le quizz", quiz_attempts_path(@quiz), method: :post, class: "btn btn-primary btn-lg" %>
  </div>

  <!-- Previous Attempts -->
  <% if @user_attempts.any? %>
    <div class="card mt-4">
      <div class="card-header">
        <h5>Mes tentatives</h5>
      </div>
      <div class="card-body">
        <table class="table table-striped">
          <thead>
            <tr>
              <th>Date</th>
              <th>Score</th>
              <th>Statut</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <% @user_attempts.each do |attempt| %>
              <tr>
                <td><%= attempt.created_at.strftime("%d/%m/%Y %H:%M") %></td>
                <td>
                  <% if attempt.done? %>
                    <%= attempt.score %>/<%= attempt.total_questions %> (<%= attempt.percentage_score %>%)
                  <% else %>
                    -
                  <% end %>
                </td>
                <td>
                  <% if attempt.done? %>
                    <span class="badge bg-success">Termine</span>
                  <% else %>
                    <span class="badge bg-warning">En cours</span>
                  <% end %>
                </td>
                <td>
                  <%= link_to "Voir", quiz_attempt_path(@quiz, attempt), class: "btn btn-sm btn-outline-primary" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    </div>
  <% end %>

  <div class="flashcard-actions-footer">
    <%= link_to "â† Retour aux quizz", quizzes_path, class: "btn-back-to-lecture" %>
  </div>
</div>
